# Contributing to Five Forks Fire Weather Dashboard

Thank you for your interest in contributing to the Five Forks Fire Weather Dashboard! This document provides guidelines for maintaining and deploying changes to the dashboard.

## Pre-Deployment Checklist

Before deploying changes to the live GitHub Pages site, complete these checks:

### 1. Fuel Calculator Validation

- [ ] Open `fuel-calculator-test.html` in a browser
- [ ] Verify all test sections run without errors:
  - EMC Calculation Validation
  - Time-Lag Drying Model
  - Virginia Drying Scenario
  - Critical Fire Weather
- [ ] Check browser console for errors (should show "Tests Complete")
- [ ] Verify test results are reasonable (EMC values 0-60%, moisture decreases over drying period)

### 2. Diagnostic Checks

#### Browser Diagnostics

- [ ] Open `diagnostics.html` in a browser
- [ ] Click "Run All Checks"
- [ ] Verify all critical checks pass (green ‚úÖ):
  - fuel-calculator.js loaded
  - data/counties.json accessible
  - dashboard.js loaded
  - Leaflet.js loaded
  - window.computeEMC() available
  - window.stepMoisture() available
  - window.runFuelMoistureModel() available
- [ ] Review any warnings (yellow ‚ö†Ô∏è) - these are non-critical but should be noted

#### Python Diagnostics

- [ ] Run `python diagnostic_check.py`
- [ ] Verify all checks pass
- [ ] Confirm county count matches expectations
- [ ] Verify color logic is implemented

### 3. Main Dashboard Testing

- [ ] Open `index.html` in a browser
- [ ] Check browser DevTools console for errors
- [ ] Verify county cards load (or show appropriate error with retry button)
- [ ] Test theme toggle button
- [ ] Test refresh button
- [ ] Verify map displays with tiles
- [ ] Click "Fuel Calc" button
- [ ] In Fuel Calculator modal:
  - [ ] Verify 5 forecast days are shown in table
  - [ ] Enter test data
  - [ ] Click "Run Fuel Moisture Model"
  - [ ] Verify results table appears
  - [ ] Check for critical warnings when appropriate
  - [ ] Close modal with X button

### 4. Brief Generator Script

If you've modified the brief generation script:

- [ ] Ensure Python 3.7+ is installed
- [ ] Verify `python-docx` dependency is installed: `pip install python-docx`
- [ ] Run: `python scripts/build_five_forks_brief.py`
- [ ] Verify a new .docx file is created in `briefs/`
- [ ] Open the generated .docx file and check formatting
- [ ] Verify county data is populated correctly

### 5. Code Quality

- [ ] No unused variables or functions
- [ ] Console.log statements are intentional (for debugging) or removed
- [ ] Code follows existing style conventions
- [ ] Comments explain complex logic
- [ ] Error handling is in place for external API calls

### 6. Files to Check

- [ ] `index.html` - main dashboard page
- [ ] `dashboard.js` - core logic
- [ ] `fuel-calculator.js` - fuel moisture calculations
- [ ] `data/counties.json` - county data (if modified)
- [ ] `style.css` - styling (if modified)
- [ ] `README.md` - documentation (if instructions changed)

### 7. Git Best Practices

- [ ] Meaningful commit messages
- [ ] Each commit represents a logical unit of work
- [ ] No sensitive data (API keys, credentials) committed
- [ ] .gitignore excludes build artifacts, dependencies, temp files

## Common Pitfalls

### GitHub Pages Deployment

‚ö†Ô∏è **Case Sensitivity**: GitHub Pages is case-sensitive. Ensure:
- File references match exact case (`data/counties.json` not `Data/Counties.json`)
- HTML links use correct case
- Script src attributes match filename case

‚ö†Ô∏è **Relative Paths**: Always use relative paths:
- ‚úÖ `data/counties.json`
- ‚ùå `/data/counties.json` (absolute path may break)

‚ö†Ô∏è **Script Load Order**: In `index.html`, load scripts in this order:
1. External libraries (Leaflet, PapaParse)
2. `fuel-calculator.js` (must load before dashboard.js)
3. `dashboard.js`

### Testing Locally

When testing locally:
- Use a local web server (not `file://` URLs)
- Python: `python -m http.server 8000`
- Node.js: `npx http-server`
- VS Code: Use Live Server extension

### Data Files

- `county_data.json` - Generated by GitHub Actions workflow
- `firms_data.json` - Generated by GitHub Actions workflow
- `data/counties.json` - Manually maintained county list (edit as needed)

## Making Changes

### Adding/Updating Counties

1. Edit `data/counties.json`
2. Add or modify county entries with `name`, `lat`, `lon`
3. Optional: Add `type: "city"` for independent cities
4. Run `python diagnostic_check.py` to validate
5. Test in browser with diagnostics.html

### Modifying Fuel Calculator

1. Edit `fuel-calculator.js`
2. Ensure functions are exported to `window` object
3. Run `fuel-calculator-test.html` to validate
4. Update tests if calculation logic changed

### Updating Dashboard UI

1. Edit `dashboard.js` or `index.html`
2. Test all interactive elements
3. Check responsive design (mobile, tablet, desktop)
4. Verify accessibility (keyboard navigation, screen readers)

## Deployment Process

1. Complete all items in Pre-Deployment Checklist
2. Commit changes with descriptive message
3. Push to repository
4. GitHub Actions will automatically deploy to Pages
5. Wait 1-2 minutes for deployment
6. Visit live site and verify changes
7. Check browser console on live site for errors

## Need Help?

- Review existing code for patterns and conventions
- Check browser console for error messages
- Use diagnostics.html to identify issues
- Run diagnostic_check.py for data validation
- Test locally before pushing to GitHub

## Security

- Never commit API keys or credentials
- Sanitize user inputs in any form fields
- Validate data from external sources
- Use HTTPS for all external resources
- Review dependencies for vulnerabilities

## Questions?

Open an issue in the repository for questions or suggestions.

---

**Thank you for contributing to safer fire weather monitoring!** üî•
